---
import Layout from '../layouts/Layout.astro'
import MapContainer from '../components/MapContainer'
---

<Layout>
  <main class="bg-furious-bg text-furious-text h-dvh overflow-hidden flex flex-col font-furious p-4">
    <div class="container mx-auto flex-1 flex flex-col justify-center min-h-0">
      <!-- Header -->
      <header class="text-center py-4 short:py-2 shrink-0">
        <div class="text-6xl short:text-5xl mb-2 short:mb-1">ğŸš—ğŸ’¢</div>
        <h1 class="text-3xl short:text-2xl font-black uppercase tracking-tight text-furious-primary">ä½ æŒ¡ä½æˆ‘äº†ï¼</h1>
        <p class="text-xl short:text-lg opacity-60 mt-1">è¯·ç«‹å³æŒªè½¦</p>
      </header>

      <!-- Message Form -->
      <section class="flex-1 flex flex-col gap-3 max-w-2xl mx-auto w-full min-h-0 justify-center">
        <label class="flex flex-col min-h-0 shrink-0">
          <span class="text-sm font-bold uppercase tracking-wide opacity-80 mb-2 block shrink-0"> ğŸ“ ç•™è¨€ç»™è½¦ä¸» </span>
          <textarea
            id="message"
            class="w-full h-40 short:h-24 bg-white/10 border-2 border-furious-primary/50 text-furious-text p-4 short:p-2 text-base resize-none focus:outline-none focus:border-furious-primary placeholder:text-white/30 rounded-lg"
            placeholder="ä¾‹å¦‚ï¼šæ‚¨å¥½ï¼Œæ‚¨çš„è½¦æŒ¡ä½äº†æˆ‘çš„è½¦é“ï¼Œéº»çƒ¦å°½å¿«æŒªä¸€ä¸‹ï¼Œè°¢è°¢ï¼"></textarea>
        </label>

        <!-- Quick Messages -->
        <div class="flex flex-wrap gap-2 shrink-0">
          <button class="quick-msg bg-white/10 px-3 py-2 short:py-1 text-sm border border-white/20 hover:bg-white/20 transition-colors rounded-lg flex-1 text-center whitespace-nowrap">
            ğŸš¨ ç´§æ€¥ï¼
          </button>
          <button class="quick-msg bg-white/10 px-3 py-2 short:py-1 text-sm border border-white/20 hover:bg-white/20 transition-colors rounded-lg flex-1 text-center whitespace-nowrap">
            ğŸ™ éº»çƒ¦æ‚¨äº†
          </button>
          <button class="quick-msg bg-white/10 px-3 py-2 short:py-1 text-sm border border-white/20 hover:bg-white/20 transition-colors rounded-lg flex-1 text-center whitespace-nowrap">
            â° æˆ‘èµ¶æ—¶é—´
          </button>
        </div>

        <!-- Location Map -->
        <MapContainer client:only="react" />
      </section>

      <!-- Send Button -->
      <footer class="py-4 short:py-2 max-w-2xl mx-auto w-full shrink-0">
        <button
          id="sendBtn"
          class="w-full bg-furious-primary text-white font-black text-xl short:text-lg py-4 short:py-3 rounded-xl uppercase tracking-wider hover:bg-red-600 active:scale-95 transition-all shadow-lg shadow-furious-primary/30"
        >
          ğŸ“£ å‘é€é€šçŸ¥
        </button>
        <p class="text-center text-xs opacity-40 mt-3">ç‚¹å‡»åå°†ç«‹å³é€šçŸ¥è½¦ä¸»</p>
      </footer>
    </div>
  </main>
</Layout>

<script>
  // Quick message buttons
  document.querySelectorAll('.quick-msg').forEach((btn) => {
    btn.addEventListener('click', () => {
      const textarea = document.getElementById('message') as HTMLTextAreaElement
      const text = btn.textContent?.trim() || ''
      textarea.value = textarea.value ? `${textarea.value} ${text}` : text
      textarea.focus()
    })
  })

  // Send button
  document.getElementById('sendBtn')?.addEventListener('click', () => {
    const textarea = document.getElementById('message') as HTMLTextAreaElement
    const message = textarea.value.trim()

    if (!message) {
      alert('è¯·è¾“å…¥ç•™è¨€å†…å®¹ ğŸ“')
      return
    }

    // TODO: Implement actual notification sending
    alert(`é€šçŸ¥å·²å‘é€ï¼ğŸš€\n\nç•™è¨€å†…å®¹ï¼š${message}`)
  })
</script>
